<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ุณุฌู ุงูุตูุงูุฉ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>๐๏ธ ุณุฌู ุงูุตูุงูุฉ</h1>

  <!-- ูููู ุงุฎุชูุงุฑ ุงููุฑุน + ุจูุงูุงุช ุงููุณุชุฎุฏู -->
  <div id="component"></div>

  <table id="maintenance-table">
    <thead>
      <tr>
        <th>ุฑูู ุงูุทูุจ</th>
        <th>ุงููุญุฏุฉ</th>
        <th>ุงููุณุชุฃุฌุฑ</th>
        <th>ุงููุตู</th>
        <th>ุงูุชุงุฑูุฎ</th>
        <th>ุงูุญุงูุฉ</th>
        <th>ุงูุฅุฌุฑุงุกุงุช</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="actions" style="text-align:center;">
    <a href="add-maintenance.html" class="btn primary">โ ุฅุถุงูุฉ ุทูุจ ุตูุงูุฉ</a>
    <button id="printBtn" class="btn info">๐จ๏ธ ุทุจุงุนุฉ ุงูุณุฌู</button>
  </div>

  <script type="module">
    import { initComponent } from './scripts/component.js';
    import { fetchJSON, statusClass } from './scripts/utils.js';
    import { getSession } from './scripts/auth.js';
    import { guardButton } from './scripts/permissions.js';

    // ุชูุนูู ุงููููู ุงูููุญุฏ (ุงุฎุชูุงุฑ ุงููุฑุน + ุงูุตูุงุญูุงุช)
    initComponent("component", [
      { selector: ".btn.primary", section: "ุตูุงูุฉ", action: "ุฅุถุงูุฉ" },
      { selector: "#printBtn", section: "ุตูุงูุฉ", action: "ุทุจุงุนุฉ" }
    ]);

    const session = getSession();

    async function loadMaintenance() {
      const maintenance = await fetchJSON('data/maintenance.json');
      const tenants = await fetchJSON('data/tenants.json');
      const units = await fetchJSON('data/units.json');

      // ููุชุฑุฉ ุทูุจุงุช ุงูุตูุงูุฉ ุญุณุจ ุงููุฑุน
      const branchMaintenance = maintenance.filter(m => m.branch === session.branch);

      const tbody = document.querySelector('#maintenance-table tbody');
      tbody.innerHTML = branchMaintenance.map(m => {
        const tenant = tenants.find(t => t.id === m.tenantId);
        const unit = units.find(u => u.id === m.unitId);
        return `
          <tr>
            <td>${m.id}</td>
            <td>${unit ? unit.name : m.unitId}</td>
            <td>${tenant ? tenant.name : m.tenantId}</td>
            <td>${m.description}</td>
            <td>${m.date}</td>
            <td><span class="status ${statusClass(m.status)}">${m.status}</span></td>
            <td>
              <button class="btn warning">ุชุญุฏูุซ ุงูุญุงูุฉ</button>
              <button class="btn danger">ุญุฐู</button>
            </td>
          </tr>
        `;
      }).join('');

      // ุชุทุจูู ุงูุตูุงุญูุงุช ุนูู ุงูุฃุฒุฑุงุฑ
      setTimeout(() => {
        document.querySelectorAll('.btn.warning
